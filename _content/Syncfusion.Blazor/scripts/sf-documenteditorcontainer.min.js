(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{"./bundles/sf-documenteditorcontainer.js":function(e,t,n){"use strict";n.r(t);n("./modules/sf-documenteditorcontainer.js")},"./modules/sf-documenteditorcontainer.js":function(e,t){window.sfBlazor=window.sfBlazor||{},window.sfBlazor.DocumentEditorContainer=function(){"use strict";var e=function(){function e(e,t,n,i,o){window.sfBlazor=window.sfBlazor,this.previousContext="",this.showHeaderProperties=!0,this.element=t,sf.base.isNullOrUndefined(t)||(this.dotNetRef=o,this.element=t,this.dataId=e,window.sfBlazor.setCompInstance(this),this.options=n,this.editorOptions=i,this.updateOptions(n))}return Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.documentEditorInternal},enumerable:!0,configurable:!0}),e.prototype.updateOptions=function(e){this.showPropertiesPane=e.showPropertiesPane,this.currentUser=e.currentUser,this.enableComment=e.enableComment,this.enableLocalPaste=e.enableLocalPaste,this.enableSpellCheck=e.enableSpellCheck,this.enableTrackChanges=e.enableTrackChanges,this.height=e.height,this.serviceUrl=e.serviceUrl,this.userColor=e.userColor,this.width=e.width,this.zIndex=e.zIndex,this.requiredModules()},e.prototype.setOptions=function(e,t){for(var n=0,i=Object.keys(e);n<i.length;n++){var o=i[n],s=e[o];if(!sf.base.isNullOrUndefined(s))switch(o){case"zoomFactor":this.documentEditor.zoomFactor=s,this.documentEditor.onPropertyChanged({zoomFactor:s},null);break;case"layoutType":this.documentEditor.layoutType=s,this.documentEditor.onPropertyChanged({layoutType:s},null);break;case"enableTrackChanges":this.enableTrackChanges=s,this.documentEditor.enableTrackChanges=s,this.documentEditor.showRevisions=s,this.documentEditor.onPropertyChanged({enableTrackChanges:s},null),this.documentEditor.onPropertyChanged({showRevisions:s},null);break;case"restrictEditing":this.restrictEditing=s,this.documentEditor.isReadOnly=s,this.documentEditor.onPropertyChanged({isReadOnly:s},null);break;case"enableLocalPaste":this.enableLocalPaste=s,this.documentEditor.enableLocalPaste=s,this.documentEditor.onPropertyChanged({enableLocalPaste:s},null)}}},e.prototype.getModuleName=function(){return"DocumentEditorContainer"},e.prototype.onPropertyChanged=function(e,t){for(var n=0,i=Object.keys(e);n<i.length;n++){switch(i[n]){case"restrictEditing":this.documentEditor.isReadOnly=e.restrictEditing,sf.base.isNullOrUndefined(this.documentEditor.trackChangesPane)||this.documentEditor.trackChangesPane.enableDisableButton(!e.restrictEditing&&!this.documentEditor.documentHelper.isDocumentProtected);break;case"showPropertiesPane":this.showHidePropertiesPane(e.showPropertiesPane);break;case"enableTrackChanges":this.documentEditor&&(this.documentEditor.enableTrackChanges=e.enableTrackChanges,this.documentEditor.showRevisions=e.enableTrackChanges,this.documentEditor.resize());break;case"enableLocalPaste":this.documentEditor&&(this.documentEditor.enableLocalPaste=e.enableLocalPaste);break;case"serviceUrl":this.documentEditor&&(this.documentEditor.serviceUrl=e.serviceUrl);break;case"serverActionSettings":this.documentEditor&&this.setserverActionSettings();break;case"zIndex":this.documentEditor&&(this.documentEditor.zIndex=e.zIndex);break;case"headers":break;case"locale":case"enableRtl":break;case"enableComment":this.documentEditor&&(this.documentEditor.enableComment=e.enableComment);break;case"enableSpellCheck":this.documentEditor&&(this.documentEditor.enableSpellCheck=e.enableSpellCheck);break;case"documentEditorSettings":this.documentEditor&&this.customizeDocumentEditorSettings();break;case"toolbarItems":break;case"currentUser":this.documentEditor&&(this.documentEditor.currentUser=e.currentUser);break;case"userColor":this.documentEditor&&(this.documentEditor.userColor=e.userColor);break;case"layoutType":this.documentEditor&&(this.documentEditor.layoutType=e.layoutType);break;case"enableToolbar":this.documentEditor&&this.documentEditor.resize();break;case"height":var o="";o=-1!==this.height.indexOf("%")?window.innerHeight*(parseInt(this.height)/100)+"px":sf.base.formatUnit(this.height),this.element.style.height=o,this.documentEditor&&this.documentEditor.resize();break;case"width":this.element.style.width=sf.base.formatUnit(this.width),this.documentEditor&&this.documentEditor.resize()}}},e.prototype.preRender=function(e){var t="";t=-1!==this.height.indexOf("%")?window.innerHeight*(parseInt(this.height)/100)+"px":sf.base.formatUnit(this.height),this.element.style.height=t,""!==this.width&&(this.element.style.width=sf.base.formatUnit(this.width)),this.element.style.minHeight="320px"},e.prototype.render=function(e,t){this.initializeDocumentEditor(e,t),this.setserverActionSettings(),this.customizeDocumentEditorSettings()},e.prototype.setFormat=function(){},e.prototype.setserverActionSettings=function(){},e.prototype.customizeDocumentEditorSettings=function(){},e.prototype.getPersistData=function(){return"documenteditor-container"},e.prototype.requiredModules=function(){var e=[];return this.enableToolbar&&e.push({member:"toolbar",args:[this]}),e},e.prototype.initializeDocumentEditor=function(e,t){var n=t,i=window.sfBlazor.getCompInstance(e);this.documentEditorInternal=i,sf.base.EventHandler.add(n,"selectionChange",this.onSelectionChange,this),this.documentEditor.enableAllModules(),this.documentEditor.enableComment=this.enableComment,this.setFormat(),this.documentEditor.resize()},e.prototype.showHidePropertiesPane=function(e){this.showPropertiesPane&&this.showPropertiesPaneOnSelection(),this.documentEditor.resize()},e.prototype.resize=function(e,t){this.element&&(sf.base.isNullOrUndefined(t)&&this.element&&this.element.parentElement.parentElement&&(t=this.element.parentElement.parentElement.clientHeight),sf.base.isNullOrUndefined(e)&&this.element&&this.element.parentElement.parentElement&&(e=this.element.parentElement.parentElement.clientWidth),!sf.base.isNullOrUndefined(e)&&e>200&&(this.width=e.toString(),this.element.style.width=e+"px"),!sf.base.isNullOrUndefined(t)&&t>200&&(this.height=t.toString(),this.element.style.height=t+"px"),this.documentEditor&&this.documentEditor.resize())},e.prototype.onContentChange=function(){},e.prototype.onDocumentChange=function(){this.enableTrackChanges=this.documentEditor.enableTrackChanges},e.prototype.onSelectionChange=function(){this.showPropertiesPaneOnSelection()},e.prototype.showPropertiesPaneOnSelection=function(){var e=this.documentEditor.selection.contextType,t=e.indexOf("Header")>=0||e.indexOf("Footer")>=0;t||(this.showHeaderProperties=!0,this.documentEditor.fireBeforePaneSwitch("PropertiesPane")),this.showPropertiesPane?t&&this.showHeaderProperties?this.showProperties("headerfooter"):e.indexOf("List")>=0||e.indexOf("Text")>=0&&e.indexOf("Table")<0?this.showProperties("text"):e.indexOf("Image")>=0?this.showProperties("image"):e.indexOf("TableOfContents")>=0?this.showProperties("toc"):e.indexOf("Table")>=0&&this.showProperties("table"):this.showHidePropertiesPane(!1),this.previousContext=this.documentEditor.selection.contextType},e.prototype.showProperties=function(e){this.tableProperties.showTableProperties("text"===e||"table"===e),this.imageProperties.showImageProperties("image"===e),this.headerFooterProperties.showHeaderFooterPane("headerfooter"===e),this.tocProperties.showTocPane("toc"===e)},e.prototype.destroy=function(){this.propertiesPaneContainer&&this.editorContainer.parentElement&&(this.propertiesPaneContainer.innerHTML="",this.propertiesPaneContainer.parentElement.removeChild(this.propertiesPaneContainer)),this.propertiesPaneContainer=void 0,this.editorContainer&&this.editorContainer.parentElement&&(this.editorContainer.innerHTML="",this.editorContainer.parentElement.removeChild(this.editorContainer)),this.statusBarElement&&this.statusBarElement.parentElement&&(this.statusBarElement.innerHTML="",this.statusBarElement.parentElement.removeChild(this.statusBarElement)),this.containerTarget&&this.containerTarget.parentElement&&(this.containerTarget.innerHTML="",this.containerTarget.parentElement.removeChild(this.containerTarget)),this.containerTarget=void 0,this.statusBarElement=void 0,this.editorContainer=void 0},e}(),t=function(e){var t=this;this.showImageProperties=function(e){!e&&"none"===t.element.style.display||e&&"block"===t.element.style.display||(t.element.style.display=e?"block":"none")},this.element=e},n=function(e){var t=this;this.showTableProperties=function(e){!e&&"none"===t.element.style.display||e&&"block"===t.element.style.display||(t.element.style.display=e?"block":"none")},this.element=e},i=function(e){var t=this;this.showTocPane=function(e){!e&&"none"===t.element.style.display||e&&"block"===t.element.style.display||(t.element.style.display=e?"block":"none")},this.element=e},o=function(){function e(e){this.element=e}return e.prototype.onSelectionChange=function(){},e.prototype.showHeaderFooterPane=function(e){e&&this.onSelectionChange(),!e&&"none"===this.element.style.display||e&&"block"===this.element.style.display||(this.element.style.display=e?"block":"none")},e}(),s=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function r(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(r,a)}l((i=i.apply(e,t||[])).next())}))},r=function(e,t){var n,i,o,s,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=2&s[0]?i.return:s[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;switch(i=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,i=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){r.label=s[1];break}if(6===s[0]&&r.label<o[1]){r.label=o[1],o=s;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(s);break}o[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],i=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};return{dotnetRef:null,filePicker:null,imagePicker:null,docEditElement:null,docEditDataId:null,initialize:function(s,r,a,l,d,h,c,u){sf.base.enableBlazorMode();var m=new e(s,r,d,h,c);if(m.tableProperties=new n(u[0]),m.imageProperties=new t(u[1]),m.headerFooterProperties=new o(u[2]),m.tocProperties=new i(u[3]),m.preRender(l),m.render(a,l),this.dotnetRef=c,this.docEditElement=l,this.docEditDataId=a,l.parentElement){var p=l.parentElement.getElementsByClassName("e-de-ctnr-file-picker"),f=l.parentElement.getElementsByClassName("e-de-ctnr-image-picker");p.length>0&&(this.filePicker=p[0],this.filePicker.addEventListener("change",this.fileReader.bind(this))),f.length>0&&(this.imagePicker=f[0],this.imagePicker.addEventListener("change",this.imageReader.bind(this)))}},updateOptions:function(e,t,n){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.setOptions(t,i.options),i.options=t)},imageReader:function(){return s(this,void 0,void 0,(function(){var e,t,n,i;return r(this,(function(o){return t=(e=this).imagePicker.files[0],n=new FileReader,i=window.sfBlazor.getCompInstance(e.docEditDataId),n.onload=function(){var e=n.result,t=document.createElement("img");t.addEventListener("load",(function(){i.editor.insertImage(e,this.width,this.height)})),t.src=e},n.readAsDataURL(t),[2]}))}))},fileReader:function(){return s(this,void 0,void 0,(function(){var e,t,n,i,o;return r(this,(function(s){return this.dotnetRef.invokeMethodAsync("ShowSpinner"),(t=(e=this).filePicker.files[0])&&(n=t.name,i=n.substr(n.lastIndexOf(".")),(o=new FileReader).onload=function(){var t=o.result;e.dotnetRef.invokeMethodAsync("LoadDocument",t,n)},".sfdt"===i?o.readAsText(t):o.readAsDataURL(t)),[2]}))}))},openDocument:function(e,t){var n=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.element)||("File"==t?this.filePicker&&(this.filePicker.value="",this.filePicker.click()):"Image"==t&&this.imagePicker&&(this.imagePicker.value="",this.imagePicker.click()))},showProperties:function(e,t){var n=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.element)||n.showProperties(t)},resize:function(e,t,n){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.resize(t,n)},setShowHeaderProperties:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||(t.showHeaderProperties=!t.showHeaderProperties)},showPropertiesPaneOnSelection:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.showPropertiesPaneOnSelection()},getPreviousContext:function(e){var t=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)?"":t.previousContext},navigateToUrl:function(e){window.open(e)}}}()}}]);(async()=>{await import(`${document.baseURI}_content/Syncfusion.Blazor/scripts/syncfusion-blazor-base.min.js`).then(()=>{})})();